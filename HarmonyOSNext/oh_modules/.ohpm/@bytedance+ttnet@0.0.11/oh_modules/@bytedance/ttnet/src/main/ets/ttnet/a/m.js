import taskpool from '@ohos.taskpool'; import util from '@ohos.util'; import { TTJson } from "../p/n1"; export class JSONConverter { async covertResponseBody(body) { try { let task = new taskpool.Task(parseJsonData, body); return await taskpool.execute(task); } catch (e) { throw new Error("covertResponseBody failed"); } } } function parseJsonData(data) { "use concurrent"; let v8 = util.TextDecoder.create("utf-8", { ignoreBOM: true }); const w8 = v8.decodeToString(new Uint8Array(data), { stream: false }); return TTJson.parse(w8); } export const jsonConverter = new JSONConverter(); 